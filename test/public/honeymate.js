var e;async function t(e){await new Promise(t=>setTimeout(t,e))}let n=/url\(\s*(['"]?)(.*)\1\s*\)/;async function o(e){return await new Promise(t=>{let n=new Image;n.onload=()=>{t(!0)},n.onerror=()=>{t(!1)},n.src=e})}!function(e){e.top="top",e.right="right",e.bottom="bottom",e.left="left"}(e||(e={}));let r="IntersectionObserver"in window;function a(e,t=0){return e?parseInt(e,10):t}class s{constructor(t){this.node=t,this.images=[],this.params=function(t){return{direction:t.left?e.left:t.right?e.right:t.bottom?e.bottom:e.top,duration:a(t.duration,640),effect:t.effect?t.effect:"fade",expose:r&&"true"===t.expose,delay:a(t.delay,0),hold:a(t.hold,0),scale:function(e,t=0){return e?parseFloat(e):t}(t.scale,.87),await:t.await??"",origin:t.origin?t.origin:e.top,offset:a(t.up)??a(t.down)??a(t.left)??a(t.right)??32,spin:"true"===t.spin,spinColor:t["spin-color"]??"#000",spinSize:a(t["spin-size"],24),continue:"true"===t.continue}}(t.dataset),this.images=function(e){let t=[],o=Array.from(e.querySelectorAll("*"));o.push(e);for(let e=0;e<o.length;e++)if(o[e]?.tagName==="IMG")t.push(o[e].src);else{let r=function(e){let t=getComputedStyle(e),o=[t.background,t.backgroundImage];for(let e=0;e<o.length;e++){let t=function(e){if(!e||""===e)return;let t=e.match(n);if(null!==t)return t[2]}(o[e]);if(t)return t}}(o[e]);r&&t.push(r)}return t}(t)}async ready(){let e=this.images.map(o);await Promise.all(e)}async show(){this.params.hold&&await t(this.params.hold),console.log("show",this.node);let e=this.node.animate([{opacity:0},{opacity:1}],{duration:this.params.duration,iterations:1});e.onfinish=()=>{this.node.classList.remove("honey")},e.play()}}let i=new class{has(e){return this.storage.has(e)}getElement(e){if(this.storage.has(e))return this.storage.get(e);let t=new s(e);return this.storage.set(e,t),t}get size(){return this.storage.size}getByIndex(e){let t=Array.from(this.storage.keys())[e];return this.storage.get(t)}add(e){if(this.storage.has(e))throw Error("Element already exists");let t=new s(e);return this.storage.set(e,t),t}constructor(){this.storage=new Map}};function l(){let e=document.querySelectorAll(".honey");console.log({nodes:e});for(let t=0;t<e.length;t++){if(!e[t])continue;let n=i.getElement(e[t]),o=function(e,t){if(e.params.continue&&t>1)return i.getByIndex(t-1);if(e.params.await){let t=document.getElementById(e.params.await);return t?i.getElement(t):void 0}}(n,t);o?o.ready().then(async()=>{await n.ready()}).then(n.show).catch(console.error):(console.log(n),n.ready().then(async()=>{await n.show()}).catch(console.error))}}function c(){let e=document.createElement("style");e.innerHTML=".honey{opacity: 0}",document.head.appendChild(e)}export{l as animate,c as attachStyles};
//# sourceMappingURL=index.esm.js.map
